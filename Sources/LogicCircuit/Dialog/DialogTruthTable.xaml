<Window x:Class="LogicCircuit.DialogTruthTable"
	xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
	xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
	xmlns:lc="clr-namespace:LogicCircuit"
	WindowStartupLocation="CenterOwner"
	Title="{Binding Source={x:Static lc:Resources.CommandTruthTable}, Mode=OneTime}"
	Style="{DynamicResource DialogWindow}"
	MinWidth="480" MinHeight="320"
	FocusManager.FocusedElement="{Binding ElementName=dataGrid}"
>
	<Window.Resources>
		<BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter"/>
		<lc:InverseBooleanConverter x:Key="InverseBooleanConverter"/>
	</Window.Resources>

	<Grid>
		<Grid.RowDefinitions>
			<RowDefinition Height="Auto"/>
			<RowDefinition Height="*"/>
			<RowDefinition Height="Auto"/>
		</Grid.RowDefinitions>

		<Grid.ColumnDefinitions>
			<ColumnDefinition Width="Auto"/>
			<ColumnDefinition Width="*"/>
			<ColumnDefinition Width="Auto"/>
			<ColumnDefinition Width="Auto"/>
		</Grid.ColumnDefinitions>

		<Label Grid.Row="0" Grid.Column="0" Content="_Filter:" Target="{Binding ElementName=filter}" VerticalAlignment="Center"/>
		<TextBox Grid.Row="0" Grid.Column="1" Name="filter" VerticalAlignment="Center"/>
		<CheckBox Grid.Row="0" Grid.Column="2" Content="_Invert" IsChecked="{Binding Path=InvertFilter}" VerticalAlignment="Center"/>
		<Button Grid.Row="0" Grid.Column="3" Name="buttonApply" Content="_Apply" Click="ButtonApplyClick" IsDefault="{Binding ElementName=filter, Path=IsFocused}" VerticalAlignment="Center"/>

		<DataGrid Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="4" Name="dataGrid" AutoGenerateColumns="False" IsReadOnly="True" Margin="3"
			VirtualizingStackPanel.IsVirtualizing="True" VirtualizingStackPanel.VirtualizationMode="Standard"
			ItemsSource="{Binding Path=TruthTable}"
		>
			<DataGrid.CellStyle>
				<Style TargetType="DataGridCell">
					<Setter Property="HorizontalAlignment" Value="Right"/>
				</Style>
			</DataGrid.CellStyle>
		</DataGrid>

		<WrapPanel Grid.Row="2" Grid.Column="0" Grid.ColumnSpan="3" Orientation="Horizontal" VerticalAlignment="Top">
			<WrapPanel.Resources>
				<Style TargetType="TextBlock">
					<Setter Property="Margin" Value="5,2"/>
				</Style>
			</WrapPanel.Resources>
			
			<StackPanel Orientation="Horizontal">
				<TextBlock Text="Total rows:"/>
				<TextBlock Text="{Binding Path=TotalRows}"/>
			</StackPanel>

			<StackPanel Orientation="Horizontal">
				<TextBlock Text="Displayed rows:"/>
				<TextBlock Text="{Binding Path=TruthTable.Count}"/>
			</StackPanel>

			<TextBlock Visibility="{Binding Path=Truncated, Converter={StaticResource BooleanToVisibilityConverter}}" TextWrapping="Wrap"
				Text="Truth table is too long and get truncated. Please use Filter to verify correctness of your circuit"
			/>
		</WrapPanel>

		<Button Grid.Row="2" Grid.Column="3" Name="buttonOk" VerticalAlignment="Bottom"
			Content="{Binding Source={x:Static lc:Resources.TitleOK}, Mode=OneTime}"
			IsDefault="{Binding ElementName=filter, Path=IsFocused, Converter={StaticResource InverseBooleanConverter}}" IsCancel="True"
		/>
	</Grid>
</Window>
